
/**
         * –ü—Ä–∏–≤–µ—Å—Ç–∏ –¥–∏—Ñ—Ñ–µ—Ä–µ–Ω—Ü–∏–∞–ª—å–Ω–æ–µ —É—Ä–∞–≤–Ω–µ–Ω–∏–µ: ùë°ùë¶‚Ä≤‚Ä≤‚àí(ùë°+1)ùë¶‚Ä≤‚àí2(ùë°‚àí1)ùë¶ = 0 –∫ —Å–∏—Å—Ç–µ–º–µ –¥–≤—É—Ö –¥–∏—Ñ—Ñ–µ—Ä–µ–Ω—Ü–∏–∞–ª—å–Ω—ã—Ö —É—Ä–∞–≤–Ω–µ–Ω–∏–π –ø–µ—Ä–≤–æ–≥–æ –ø–æ—Ä—è–¥–∫–∞.
         * –ù–∞—á–∞–ª—å–Ω—ã–µ —É—Å–ª–æ–≤–∏—è: ùë¶(ùë°=1) = e2; ùë¶‚Ä≤(ùë°=1) = 2e2
         * –¢–æ—á–Ω–æ–µ —Ä–µ—à–µ–Ω–∏–µ: ùë¶(ùë°) = ùëí2t
         * –†–µ—à–∏—Ç—å –Ω–∞ –∏–Ω—Ç–µ—Ä–≤–∞–ª–µ 1<= t <= 2
         * 1) –∏—Å–ø–æ–ª—å–∑—É—è –ø—Ä–æ–≥—Ä–∞–º–º—É RKF45 —Å —à–∞–≥–æ–º –ø–µ—á–∞—Ç–∏ ‚Ñéùëùùëüùëñùëõùë° = 0.1 –∏ –≤—ã–±—Ä–∞–Ω–Ω–æ–π  –ø–æ–≥—Ä–µ—à–Ω–æ—Å—Ç—å—é EPS –≤ –¥–∏–∞–ø–∞–∑–æ–Ω–µ 0.001 ‚Äì 0.00001;
         * 2) –ò—Å–ø–æ–ª—å–∑—É—è –º–µ—Ç–æ–¥ –ê–¥–∞–º—Å–∞ 2-–π —Å—Ç–µ–ø–µ–Ω–∏ —Ç–æ—á–Ω–æ—Å—Ç–∏;
         * 3) –∏—Å–ø–æ–ª—å–∑—É—è –º–µ—Ç–æ–¥ –†—É–Ω–≥–µ-–ö—É—Ç—Ç—ã 3-–π —Å—Ç–µ–ø–µ–Ω–∏ —Ç–æ—á–Ω–æ—Å—Ç–∏;
         * 4) –∏—Å–ø–æ–ª—å–∑—É—è –º–µ—Ç–æ–¥ –†—É–Ω–≥–µ-–ö—É—Ç—Ç—ã 4-–π —Å—Ç–µ–ø–µ–Ω–∏ —Ç–æ—á–Ω–æ—Å—Ç–∏.
         * –ò—Å—Å–ª–µ–¥–æ–≤–∞—Ç—å –≤–ª–∏—è–Ω–∏–µ –≤–µ–ª–∏—á–∏–Ω—ã —à–∞–≥–∞ –∏–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞–Ω–∏—è ‚Ñéùëñùëõùë° –Ω–∞ –≤–µ–ª–∏—á–∏–Ω—ã –ª–æ–∫–∞–ª—å–Ω–æ–π –∏ –≥–ª–æ–±–∞–ª—å–Ω–æ–π –ø–æ–≥—Ä–µ—à–Ω–æ—Å—Ç–µ–π —Ä–µ—à–µ–Ω–∏—è
         * –∑–∞–¥–∞–Ω–Ω–æ–≥–æ —É—Ä–∞–≤–Ω–µ–Ω–∏—è, –¥–ª—è —ç—Ç–æ–≥–æ –≤–∑—è—Ç—å —à–∞–≥ –≤—ã—á–∏—Å–ª–µ–Ω–∏—è ‚Ñéùëñùëõùë° = (0.05, 0.025, 0.0125) .
     */

fun main() {

    val ode45 = RungeKuttaFehlburg(0.1, 1.0, 2.1)
    val ode34 = RungeKutta()
    val odeAdams = Adams()

    // —Ñ—É–Ω–∫—Ü–∏—è –¥–ª—è –≤—ã–≤–æ–¥–∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞ –≤ –∫–æ–Ω—Å–æ–ª—å
    fun printRes(name: String, solve: Map<String, Pair<Double, Double>>) {
        println(name)
        println("\tX\t\t\t\tY\t\t\t\tY'")
        for (key in solve.keys) {
            println("$key \t\t\t ${solve[key]}")
        }
    }

    printRes("–¢–æ—á–Ω–æ–µ —Ä–µ—à–µ–Ω–∏–µ", solve())
    printRes("–ê–¥–∞–º—Å–∞-–ë–∞—à—Ñ–æ—Ä—Ç–∞ 2 –ø–æ—Ä—è–¥–∫–∞", odeAdams.adamsBashforth())
    println("–ì–ª–æ–±–∞–ª—å–Ω–∞—è –ø–æ–≥—Ä–µ—à–Ω–æ—Å—Ç—å: ${globalError(localError(solve(), odeAdams.adamsBashforth()))}")
    printRes("–õ–æ–∫–∞–ª—å–Ω–∞—è –ø–æ–≥—Ä–µ—à–Ω–æ—Å—Ç—å", localError(solve(), odeAdams.adamsBashforth()))
    printRes("–ê–¥–∞–º—Å–∞-–ú–æ—É–ª—Ç–æ–Ω–∞ 2 –ø–æ—Ä—è–¥–∫–∞", odeAdams.adamasMoulton())
    println("–ì–ª–æ–±–∞–ª—å–Ω–∞—è –ø–æ–≥—Ä–µ—à–Ω–æ—Å—Ç—å: ${globalError(localError(solve(), odeAdams.adamasMoulton()))}")
    printRes("–õ–æ–∫–∞–ª—å–Ω–∞—è –ø–æ–≥—Ä–µ—à–Ω–æ—Å—Ç—å", localError(solve(), odeAdams.adamasMoulton()))
    printRes("–†—É–Ω–≥–µ-–ö—É—Ç—Ç—ã 3 –ø–æ—Ä—è–¥–∫–∞", ode34.rk3())
    println("–ì–ª–æ–±–∞–ª—å–Ω–∞—è –ø–æ–≥—Ä–µ—à–Ω–æ—Å—Ç—å: ${globalError(localError(solve(), ode34.rk3()))}")
    printRes("–õ–æ–∫–∞–ª—å–Ω–∞—è –ø–æ–≥—Ä–µ—à–Ω–æ—Å—Ç—å", localError(solve(), ode34.rk3()))
    printRes("–†—É–Ω–≥–µ-–ö—É—Ç—Ç—ã 4 –ø–æ—Ä—è–¥–∫–∞", ode34.rk4())
    println("–ì–ª–æ–±–∞–ª—å–Ω–∞—è –ø–æ–≥—Ä–µ—à–Ω–æ—Å—Ç—å: ${globalError(localError(solve(), ode34.rk4()))}")
    printRes("–õ–æ–∫–∞–ª—å–Ω–∞—è –ø–æ–≥—Ä–µ—à–Ω–æ—Å—Ç—å", localError(solve(), ode34.rk4()))
    printRes("–†—É–Ω–≥–µ-–ö—É—Ç—Ç—ã-–§–µ–ª—å–±–µ—Ä–≥–∞ 5 –ø–æ—Ä—è–¥–∫–∞", ode45.rkf45())
    println("–ì–ª–æ–±–∞–ª—å–Ω–∞—è –ø–æ–≥—Ä–µ—à–Ω–æ—Å—Ç—å: ${globalError(localError(solve(), ode45.rkf45()))}")
    printRes("–õ–æ–∫–∞–ª—å–Ω–∞—è –ø–æ–≥—Ä–µ—à–Ω–æ—Å—Ç—å", localError(solve(), ode45.rkf45()))
}